"use strict";function ReportCtrl(r){function downloadCSV(g,h){function datenum(v,a){if(a)v+=1462;var b=Date.parse(v);return(b-new Date(Date.UTC(1899,11,30)))/(24*60*60*1000)}function sheet_from_array_of_arrays(a,b){var c={};var d={s:{c:10000000,r:10000000},e:{c:0,r:0}};for(var R=0;R!=a.length;++R){for(var C=0;C!=a[R].length;++C){if(d.s.r>R)d.s.r=R;if(d.s.c>C)d.s.c=C;if(d.e.r<R)d.e.r=R;if(d.e.c<C)d.e.c=C;var e={v:a[R][C]};if(e.v==null)continue;var f=XLSX.utils.encode_cell({c:C,r:R});if(typeof e.v==='number')e.t='n';else if(typeof e.v==='boolean')e.t='b';else if(e.v instanceof Date){e.t='n';e.z=XLSX.SSF._table[14];e.v=datenum(e.v)}else e.t='s';c[f]=e}}if(d.s.c<10000000)c['!ref']=XLSX.utils.encode_range(d);return c}var k=[];$('.report tr').each(function(i,c){var d=[];$(c).find('th,td').each(function(j,b){var o=''+b.innerHTML;if($(b).hasClass("report-num")){o=parseInt(o,10)}if($(b).find('li').length>0){o="";$(b).find("li").each(function(m,a){o=o+$(a).text()+"\r\n"});o=o.slice(0,-2)}d.push(o)});k.push(d)});console.log(k);function Workbook(){if(!(this instanceof Workbook))return new Workbook();this.SheetNames=[];this.Sheets={}}var l=XLSX.utils.encode_cell({c:0,r:0});var n=sheet_from_array_of_arrays(k);var p=new Workbook();p.SheetNames.push(h);p.Sheets[h]=n;var q=XLSX.write(p,{bookType:'xlsx',bookSST:true,type:'binary'});function s2ab(s){var a=new ArrayBuffer(s.length);var b=new Uint8Array(a);for(var i=0;i!=s.length;++i)b[i]=s.charCodeAt(i)&0xFF;return a}saveAs(new Blob([s2ab(q)],{type:""}),g+".xlsx")}r.downloadCSV=function(a,b){var c=a||"";var d=b||"";downloadCSV(c,d)}}